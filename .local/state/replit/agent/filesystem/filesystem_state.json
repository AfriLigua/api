{"file_contents":{"elearning_platform/accounts/admin.py":{"content":"from django.contrib import admin\n\n# Register your models here.\n","size_bytes":63},"manage.py":{"content":"#!/usr/bin/env python\n\"\"\"Django's command-line utility for administrative tasks.\"\"\"\nimport os\nimport sys\n\n\ndef main():\n    \"\"\"Run administrative tasks.\"\"\"\n    os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'elearning_platform.settings')\n    try:\n        from django.core.management import execute_from_command_line\n    except ImportError as exc:\n        raise ImportError(\n            \"Couldn't import Django. Are you sure it's installed and \"\n            \"available on your PYTHONPATH environment variable? Did you \"\n            \"forget to activate a virtual environment?\"\n        ) from exc\n    execute_from_command_line(sys.argv)\n\n\nif __name__ == '__main__':\n    main()\n","size_bytes":674},"elearning_platform/analytics/__init__.py":{"content":"","size_bytes":0},"elearning_platform/notifications/__init__.py":{"content":"","size_bytes":0},"elearning_platform/payments/migrations/__init__.py":{"content":"","size_bytes":0},"elearning_platform/payments/admin.py":{"content":"from django.contrib import admin\n\n# Register your models here.\n","size_bytes":63},"elearning_platform/asgi.py":{"content":"\"\"\"\nASGI config for elearning_platform project.\n\nIt exposes the ASGI callable as a module-level variable named ``application``.\n\nFor more information on this file, see\nhttps://docs.djangoproject.com/en/4.2/howto/deployment/asgi/\n\"\"\"\n\nimport os\n\nfrom django.core.asgi import get_asgi_application\n\nos.environ.setdefault('DJANGO_SETTINGS_MODULE', 'elearning_platform.settings')\n\napplication = get_asgi_application()\n","size_bytes":413},"elearning_platform/courses/admin.py":{"content":"from django.contrib import admin\n\n# Register your models here.\n","size_bytes":63},"elearning_platform/messaging/admin.py":{"content":"from django.contrib import admin\n\n# Register your models here.\n","size_bytes":63},"elearning_platform/notifications/admin.py":{"content":"from django.contrib import admin\n\n# Register your models here.\n","size_bytes":63},"elearning_platform/bookings/admin.py":{"content":"from django.contrib import admin\n\n# Register your models here.\n","size_bytes":63},"elearning_platform/messaging/views.py":{"content":"from django.shortcuts import render\n\n# Create your views here.\n","size_bytes":63},"elearning_platform/bookings/migrations/__init__.py":{"content":"","size_bytes":0},"elearning_platform/messaging/apps.py":{"content":"from django.apps import AppConfig\n\n\nclass MessagingConfig(AppConfig):\n    default_auto_field = 'django.db.models.BigAutoField'\n    name = 'messaging'\n","size_bytes":150},"elearning_platform/courses/apps.py":{"content":"from django.apps import AppConfig\n\n\nclass CoursesConfig(AppConfig):\n    default_auto_field = 'django.db.models.BigAutoField'\n    name = 'courses'\n","size_bytes":146},"elearning_platform/messaging/migrations/__init__.py":{"content":"","size_bytes":0},"elearning_platform/courses/views.py":{"content":"from django.shortcuts import render\n\n# Create your views here.\n","size_bytes":63},"elearning_platform/payments/tests.py":{"content":"from django.test import TestCase\n\n# Create your tests here.\n","size_bytes":60},"elearning_platform/accounts/apps.py":{"content":"from django.apps import AppConfig\n\n\nclass AccountsConfig(AppConfig):\n    default_auto_field = 'django.db.models.BigAutoField'\n    name = 'accounts'\n","size_bytes":148},"elearning_platform/analytics/views.py":{"content":"from django.shortcuts import render\n\n# Create your views here.\n","size_bytes":63},"elearning_platform/courses/__init__.py":{"content":"","size_bytes":0},"elearning_platform/notifications/tests.py":{"content":"from django.test import TestCase\n\n# Create your tests here.\n","size_bytes":60},"elearning_platform/courses/tests.py":{"content":"from django.test import TestCase\n\n# Create your tests here.\n","size_bytes":60},"elearning_platform/notifications/models.py":{"content":"from django.db import models\nfrom django.conf import settings\n\n\nclass Notification(models.Model):\n    TYPE_CHOICES = (\n        ('email', 'Email'),\n        ('in_app', 'In-App'),\n        ('both', 'Both'),\n    )\n    \n    CATEGORY_CHOICES = (\n        ('tutor_approval', 'Tutor Approval'),\n        ('booking', 'Booking'),\n        ('payment', 'Payment'),\n        ('message', 'Message'),\n        ('withdrawal', 'Withdrawal'),\n        ('lesson', 'Lesson'),\n        ('reminder', 'Reminder'),\n        ('general', 'General'),\n    )\n    \n    user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.CASCADE, related_name='notifications')\n    title = models.CharField(max_length=255)\n    message = models.TextField()\n    notification_type = models.CharField(max_length=20, choices=TYPE_CHOICES, default='in_app')\n    category = models.CharField(max_length=50, choices=CATEGORY_CHOICES, default='general')\n    is_read = models.BooleanField(default=False)\n    link = models.CharField(max_length=255, blank=True, null=True)\n    metadata = models.JSONField(blank=True, null=True)\n    created_at = models.DateTimeField(auto_now_add=True)\n    read_at = models.DateTimeField(blank=True, null=True)\n    \n    class Meta:\n        db_table = 'notifications'\n        verbose_name = 'Notification'\n        verbose_name_plural = 'Notifications'\n        ordering = ['-created_at']\n    \n    def __str__(self):\n        return f\"{self.title} - {self.user.email}\"\n    \n    def mark_as_read(self):\n        from django.utils import timezone\n        if not self.is_read:\n            self.is_read = True\n            self.read_at = timezone.now()\n            self.save()\n","size_bytes":1645},"elearning_platform/notifications/migrations/__init__.py":{"content":"","size_bytes":0},"elearning_platform/courses/migrations/__init__.py":{"content":"","size_bytes":0},"elearning_platform/analytics/admin.py":{"content":"from django.contrib import admin\n\n# Register your models here.\n","size_bytes":63},"elearning_platform/courses/models.py":{"content":"from django.db import models\nfrom django.conf import settings\n\n\nclass Course(models.Model):\n    CATEGORY_CHOICES = (\n        ('mathematics', 'Mathematics'),\n        ('science', 'Science'),\n        ('language', 'Language'),\n        ('programming', 'Programming'),\n        ('business', 'Business'),\n        ('arts', 'Arts'),\n        ('music', 'Music'),\n        ('other', 'Other'),\n    )\n    \n    title = models.CharField(max_length=255)\n    description = models.TextField()\n    category = models.CharField(max_length=50, choices=CATEGORY_CHOICES, default='other')\n    image = models.ImageField(upload_to='courses/images/', blank=True, null=True)\n    created_by = models.ForeignKey(\n        settings.AUTH_USER_MODEL,\n        on_delete=models.CASCADE,\n        related_name='courses_created'\n    )\n    price = models.DecimalField(max_digits=10, decimal_places=2, default=0.00)\n    is_published = models.BooleanField(default=False)\n    created_at = models.DateTimeField(auto_now_add=True)\n    updated_at = models.DateTimeField(auto_now=True)\n    \n    class Meta:\n        db_table = 'courses'\n        verbose_name = 'Course'\n        verbose_name_plural = 'Courses'\n        ordering = ['-created_at']\n    \n    def __str__(self):\n        return self.title\n\n\nclass Lesson(models.Model):\n    course = models.ForeignKey(Course, on_delete=models.CASCADE, related_name='lessons')\n    title = models.CharField(max_length=255)\n    content = models.TextField(blank=True)\n    video_url = models.URLField(blank=True, null=True)\n    file = models.FileField(upload_to='lessons/files/', blank=True, null=True)\n    duration = models.IntegerField(help_text='Duration in minutes', default=0)\n    order = models.IntegerField(default=0)\n    created_at = models.DateTimeField(auto_now_add=True)\n    updated_at = models.DateTimeField(auto_now=True)\n    \n    class Meta:\n        db_table = 'lessons'\n        verbose_name = 'Lesson'\n        verbose_name_plural = 'Lessons'\n        ordering = ['order', 'created_at']\n    \n    def __str__(self):\n        return f\"{self.course.title} - {self.title}\"\n","size_bytes":2066},"elearning_platform/notifications/views.py":{"content":"from django.shortcuts import render\n\n# Create your views here.\n","size_bytes":63},"elearning_platform/bookings/apps.py":{"content":"from django.apps import AppConfig\n\n\nclass BookingsConfig(AppConfig):\n    default_auto_field = 'django.db.models.BigAutoField'\n    name = 'bookings'\n","size_bytes":148},"elearning_platform/messaging/tests.py":{"content":"from django.test import TestCase\n\n# Create your tests here.\n","size_bytes":60},"elearning_platform/accounts/views.py":{"content":"from django.shortcuts import render\n\n# Create your views here.\n","size_bytes":63},"elearning_platform/accounts/migrations/__init__.py":{"content":"","size_bytes":0},"elearning_platform/__init__.py":{"content":"","size_bytes":0},"elearning_platform/analytics/migrations/__init__.py":{"content":"","size_bytes":0},"elearning_platform/payments/apps.py":{"content":"from django.apps import AppConfig\n\n\nclass PaymentsConfig(AppConfig):\n    default_auto_field = 'django.db.models.BigAutoField'\n    name = 'payments'\n","size_bytes":148},"elearning_platform/notifications/apps.py":{"content":"from django.apps import AppConfig\n\n\nclass NotificationsConfig(AppConfig):\n    default_auto_field = 'django.db.models.BigAutoField'\n    name = 'notifications'\n","size_bytes":158},"elearning_platform/analytics/models.py":{"content":"from django.db import models\nfrom django.conf import settings\n\n\nclass Testimonial(models.Model):\n    student = models.ForeignKey(\n        settings.AUTH_USER_MODEL,\n        on_delete=models.CASCADE,\n        related_name='testimonials_given'\n    )\n    tutor = models.ForeignKey(\n        settings.AUTH_USER_MODEL,\n        on_delete=models.CASCADE,\n        related_name='testimonials_received'\n    )\n    booking = models.ForeignKey(\n        'bookings.Booking',\n        on_delete=models.CASCADE,\n        related_name='testimonials',\n        blank=True,\n        null=True\n    )\n    rating = models.IntegerField(choices=[(i, i) for i in range(1, 6)])\n    comment = models.TextField(blank=True)\n    is_approved = models.BooleanField(default=True)\n    created_at = models.DateTimeField(auto_now_add=True)\n    updated_at = models.DateTimeField(auto_now=True)\n    \n    class Meta:\n        db_table = 'testimonials'\n        verbose_name = 'Testimonial'\n        verbose_name_plural = 'Testimonials'\n        ordering = ['-created_at']\n        unique_together = ['student', 'booking']\n    \n    def __str__(self):\n        return f\"{self.student.email} â†’ {self.tutor.email} - {self.rating} stars\"\n\n\nclass StudentProgress(models.Model):\n    student = models.ForeignKey(\n        settings.AUTH_USER_MODEL,\n        on_delete=models.CASCADE,\n        related_name='progress_records'\n    )\n    lesson = models.ForeignKey('courses.Lesson', on_delete=models.CASCADE, related_name='student_progress')\n    course = models.ForeignKey('courses.Course', on_delete=models.CASCADE, related_name='student_progress')\n    is_completed = models.BooleanField(default=False)\n    completed_at = models.DateTimeField(blank=True, null=True)\n    time_spent = models.IntegerField(default=0, help_text='Time spent in minutes')\n    created_at = models.DateTimeField(auto_now_add=True)\n    updated_at = models.DateTimeField(auto_now=True)\n    \n    class Meta:\n        db_table = 'student_progress'\n        verbose_name = 'Student Progress'\n        verbose_name_plural = 'Student Progress'\n        unique_together = ['student', 'lesson']\n    \n    def __str__(self):\n        return f\"{self.student.email} - {self.lesson.title}\"\n    \n    def mark_completed(self):\n        from django.utils import timezone\n        if not self.is_completed:\n            self.is_completed = True\n            self.completed_at = timezone.now()\n            self.save()\n\n\nclass AuditLog(models.Model):\n    ACTION_CHOICES = (\n        ('login', 'Login'),\n        ('logout', 'Logout'),\n        ('profile_update', 'Profile Update'),\n        ('booking_created', 'Booking Created'),\n        ('booking_cancelled', 'Booking Cancelled'),\n        ('payment_made', 'Payment Made'),\n        ('withdrawal_requested', 'Withdrawal Requested'),\n        ('withdrawal_processed', 'Withdrawal Processed'),\n        ('course_created', 'Course Created'),\n        ('course_updated', 'Course Updated'),\n        ('tutor_approved', 'Tutor Approved'),\n        ('tutor_rejected', 'Tutor Rejected'),\n    )\n    \n    user = models.ForeignKey(\n        settings.AUTH_USER_MODEL,\n        on_delete=models.SET_NULL,\n        related_name='audit_logs',\n        null=True,\n        blank=True\n    )\n    action = models.CharField(max_length=50, choices=ACTION_CHOICES)\n    description = models.TextField()\n    ip_address = models.GenericIPAddressField(blank=True, null=True)\n    user_agent = models.CharField(max_length=255, blank=True, null=True)\n    metadata = models.JSONField(blank=True, null=True)\n    created_at = models.DateTimeField(auto_now_add=True)\n    \n    class Meta:\n        db_table = 'audit_logs'\n        verbose_name = 'Audit Log'\n        verbose_name_plural = 'Audit Logs'\n        ordering = ['-created_at']\n    \n    def __str__(self):\n        user_email = self.user.email if self.user else 'Unknown'\n        return f\"{user_email} - {self.action} - {self.created_at}\"\n","size_bytes":3876},"elearning_platform/bookings/models.py":{"content":"from django.db import models\nfrom django.conf import settings\nfrom django.utils import timezone\n\n\nclass AvailabilitySlot(models.Model):\n    tutor = models.ForeignKey(\n        settings.AUTH_USER_MODEL,\n        on_delete=models.CASCADE,\n        related_name='availability_slots'\n    )\n    start_time = models.DateTimeField()\n    end_time = models.DateTimeField()\n    is_booked = models.BooleanField(default=False)\n    created_at = models.DateTimeField(auto_now_add=True)\n    updated_at = models.DateTimeField(auto_now=True)\n    \n    class Meta:\n        db_table = 'availability_slots'\n        verbose_name = 'Availability Slot'\n        verbose_name_plural = 'Availability Slots'\n        ordering = ['start_time']\n        unique_together = ['tutor', 'start_time', 'end_time']\n    \n    def __str__(self):\n        return f\"{self.tutor.email} - {self.start_time} to {self.end_time}\"\n    \n    def get_duration_minutes(self):\n        duration = self.end_time - self.start_time\n        return int(duration.total_seconds() / 60)\n\n\nclass Booking(models.Model):\n    STATUS_CHOICES = (\n        ('pending', 'Pending Payment'),\n        ('paid', 'Paid'),\n        ('confirmed', 'Confirmed'),\n        ('completed', 'Completed'),\n        ('cancelled', 'Cancelled'),\n        ('refunded', 'Refunded'),\n    )\n    \n    student = models.ForeignKey(\n        settings.AUTH_USER_MODEL,\n        on_delete=models.CASCADE,\n        related_name='student_bookings'\n    )\n    tutor = models.ForeignKey(\n        settings.AUTH_USER_MODEL,\n        on_delete=models.CASCADE,\n        related_name='tutor_bookings'\n    )\n    course = models.ForeignKey('courses.Course', on_delete=models.CASCADE, related_name='bookings')\n    availability_slot = models.OneToOneField(\n        AvailabilitySlot,\n        on_delete=models.CASCADE,\n        related_name='booking'\n    )\n    status = models.CharField(max_length=20, choices=STATUS_CHOICES, default='pending')\n    amount = models.DecimalField(max_digits=10, decimal_places=2)\n    platform_fee = models.DecimalField(max_digits=10, decimal_places=2, default=0.00)\n    tutor_earnings = models.DecimalField(max_digits=10, decimal_places=2, default=0.00)\n    meeting_link = models.URLField(blank=True, null=True)\n    reschedule_reason = models.TextField(blank=True, null=True)\n    refund_reason = models.TextField(blank=True, null=True)\n    created_at = models.DateTimeField(auto_now_add=True)\n    updated_at = models.DateTimeField(auto_now=True)\n    \n    class Meta:\n        db_table = 'bookings'\n        verbose_name = 'Booking'\n        verbose_name_plural = 'Bookings'\n        ordering = ['-created_at']\n    \n    def __str__(self):\n        return f\"Booking #{self.id} - {self.student.email} with {self.tutor.email}\"\n    \n    def calculate_fees(self):\n        platform_fee_percentage = settings.PLATFORM_FEE_PERCENTAGE / 100\n        self.platform_fee = self.amount * platform_fee_percentage\n        self.tutor_earnings = self.amount - self.platform_fee\n        self.save()\n    \n    def can_refund(self):\n        from datetime import timedelta\n        cutoff_time = self.availability_slot.start_time - timedelta(\n            hours=settings.BOOKING_REFUND_CUTOFF_HOURS\n        )\n        return timezone.now() < cutoff_time\n","size_bytes":3221},"elearning_platform/urls.py":{"content":"\"\"\"\nURL configuration for elearning_platform project.\n\nThe `urlpatterns` list routes URLs to views. For more information please see:\n    https://docs.djangoproject.com/en/4.2/topics/http/urls/\nExamples:\nFunction views\n    1. Add an import:  from my_app import views\n    2. Add a URL to urlpatterns:  path('', views.home, name='home')\nClass-based views\n    1. Add an import:  from other_app.views import Home\n    2. Add a URL to urlpatterns:  path('', Home.as_view(), name='home')\nIncluding another URLconf\n    1. Import the include() function: from django.urls import include, path\n    2. Add a URL to urlpatterns:  path('blog/', include('blog.urls'))\n\"\"\"\nfrom django.contrib import admin\nfrom django.urls import path\n\nurlpatterns = [\n    path('admin/', admin.site.urls),\n]\n","size_bytes":774},"elearning_platform/settings.py":{"content":"import os\nfrom pathlib import Path\nfrom decouple import config, Csv\nfrom datetime import timedelta\nimport dj_database_url\n\nBASE_DIR = Path(__file__).resolve().parent.parent\n\nSECRET_KEY = config('SECRET_KEY', default='django-insecure-temporary-key-change-in-production')\nDEBUG = config('DEBUG', default=True, cast=bool)\nALLOWED_HOSTS = config('ALLOWED_HOSTS', default='*', cast=Csv())\n\nINSTALLED_APPS = [\n    'django.contrib.admin',\n    'django.contrib.auth',\n    'django.contrib.contenttypes',\n    'django.contrib.sessions',\n    'django.contrib.messages',\n    'django.contrib.staticfiles',\n    \n    'rest_framework',\n    'rest_framework_simplejwt',\n    'corsheaders',\n    'django_filters',\n    \n    'elearning_platform.accounts',\n    'elearning_platform.courses',\n    'elearning_platform.bookings',\n    'elearning_platform.payments',\n    'elearning_platform.messaging',\n    'elearning_platform.notifications',\n    'elearning_platform.analytics',\n]\n\nMIDDLEWARE = [\n    'django.middleware.security.SecurityMiddleware',\n    'corsheaders.middleware.CorsMiddleware',\n    'django.contrib.sessions.middleware.SessionMiddleware',\n    'django.middleware.common.CommonMiddleware',\n    'django.middleware.csrf.CsrfViewMiddleware',\n    'django.contrib.auth.middleware.AuthenticationMiddleware',\n    'django.contrib.messages.middleware.MessageMiddleware',\n    'django.middleware.clickjacking.XFrameOptionsMiddleware',\n]\n\nROOT_URLCONF = 'elearning_platform.urls'\n\nTEMPLATES = [\n    {\n        'BACKEND': 'django.template.backends.django.DjangoTemplates',\n        'DIRS': [BASE_DIR / 'templates'],\n        'APP_DIRS': True,\n        'OPTIONS': {\n            'context_processors': [\n                'django.template.context_processors.debug',\n                'django.template.context_processors.request',\n                'django.contrib.auth.context_processors.auth',\n                'django.contrib.messages.context_processors.messages',\n            ],\n        },\n    },\n]\n\nWSGI_APPLICATION = 'elearning_platform.wsgi.application'\n\nDATABASE_URL = config('DATABASE_URL', default=None)\nif DATABASE_URL:\n    DATABASES = {\n        'default': dj_database_url.parse(DATABASE_URL)\n    }\nelse:\n    DATABASES = {\n        'default': {\n            'ENGINE': 'django.db.backends.sqlite3',\n            'NAME': BASE_DIR / 'db.sqlite3',\n        }\n    }\n\nAUTH_PASSWORD_VALIDATORS = [\n    {'NAME': 'django.contrib.auth.password_validation.UserAttributeSimilarityValidator'},\n    {'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator', 'OPTIONS': {'min_length': 8}},\n    {'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator'},\n    {'NAME': 'django.contrib.auth.password_validation.NumericPasswordValidator'},\n]\n\nLANGUAGE_CODE = 'en-us'\nTIME_ZONE = 'UTC'\nUSE_I18N = True\nUSE_TZ = True\n\nSTATIC_URL = '/static/'\nSTATIC_ROOT = BASE_DIR / 'staticfiles'\nSTATICFILES_DIRS = [BASE_DIR / 'static'] if (BASE_DIR / 'static').exists() else []\n\nMEDIA_URL = '/media/'\nMEDIA_ROOT = BASE_DIR / 'media'\n\nDEFAULT_AUTO_FIELD = 'django.db.models.BigAutoField'\nAUTH_USER_MODEL = 'accounts.CustomUser'\n\nREST_FRAMEWORK = {\n    'DEFAULT_AUTHENTICATION_CLASSES': (\n        'rest_framework_simplejwt.authentication.JWTAuthentication',\n    ),\n    'DEFAULT_PERMISSION_CLASSES': (\n        'rest_framework.permissions.IsAuthenticated',\n    ),\n    'DEFAULT_FILTER_BACKENDS': (\n        'django_filters.rest_framework.DjangoFilterBackend',\n        'rest_framework.filters.SearchFilter',\n        'rest_framework.filters.OrderingFilter',\n    ),\n    'DEFAULT_PAGINATION_CLASS': 'rest_framework.pagination.PageNumberPagination',\n    'PAGE_SIZE': 20,\n    'DATETIME_FORMAT': '%Y-%m-%d %H:%M:%S',\n}\n\nSIMPLE_JWT = {\n    'ACCESS_TOKEN_LIFETIME': timedelta(hours=1),\n    'REFRESH_TOKEN_LIFETIME': timedelta(days=7),\n    'ROTATE_REFRESH_TOKENS': True,\n    'BLACKLIST_AFTER_ROTATION': True,\n    'ALGORITHM': 'HS256',\n    'SIGNING_KEY': SECRET_KEY,\n    'AUTH_HEADER_TYPES': ('Bearer',),\n    'USER_ID_FIELD': 'id',\n    'USER_ID_CLAIM': 'user_id',\n    'AUTH_TOKEN_CLASSES': ('rest_framework_simplejwt.tokens.AccessToken',),\n    'TOKEN_TYPE_CLAIM': 'token_type',\n}\n\nCORS_ALLOWED_ORIGINS = config('CORS_ALLOWED_ORIGINS', default='http://localhost:3000,http://localhost:5000', cast=Csv())\nCORS_ALLOW_CREDENTIALS = True\nCORS_ALLOW_ALL_ORIGINS = DEBUG\n\nCELERY_BROKER_URL = config('CELERY_BROKER_URL', default='redis://localhost:6379/0')\nCELERY_RESULT_BACKEND = config('CELERY_RESULT_BACKEND', default='redis://localhost:6379/0')\nCELERY_ACCEPT_CONTENT = ['json']\nCELERY_TASK_SERIALIZER = 'json'\nCELERY_RESULT_SERIALIZER = 'json'\nCELERY_TIMEZONE = TIME_ZONE\n\nEMAIL_BACKEND = config('EMAIL_BACKEND', default='django.core.mail.backends.console.EmailBackend')\nEMAIL_HOST = config('EMAIL_HOST', default='smtp.gmail.com')\nEMAIL_PORT = config('EMAIL_PORT', default=587, cast=int)\nEMAIL_USE_TLS = config('EMAIL_USE_TLS', default=True, cast=bool)\nEMAIL_HOST_USER = config('EMAIL_HOST_USER', default='')\nEMAIL_HOST_PASSWORD = config('EMAIL_HOST_PASSWORD', default='')\nDEFAULT_FROM_EMAIL = config('DEFAULT_FROM_EMAIL', default='noreply@elearning.com')\n\nSTRIPE_SECRET_KEY = config('STRIPE_SECRET_KEY', default='')\nSTRIPE_PUBLISHABLE_KEY = config('STRIPE_PUBLISHABLE_KEY', default='')\nSTRIPE_WEBHOOK_SECRET = config('STRIPE_WEBHOOK_SECRET', default='')\n\nPLATFORM_FEE_PERCENTAGE = config('PLATFORM_FEE_PERCENTAGE', default=15, cast=int)\nDEFAULT_CURRENCY = config('DEFAULT_CURRENCY', default='USD')\n\nBOOKING_REFUND_CUTOFF_HOURS = 24\nEMAIL_VERIFICATION_TIMEOUT_MINUTES = 10\nPASSWORD_RESET_TIMEOUT_MINUTES = 10\n\nCACHES = {\n    'default': {\n        'BACKEND': 'django_redis.cache.RedisCache',\n        'LOCATION': CELERY_BROKER_URL,\n        'OPTIONS': {\n            'CLIENT_CLASS': 'django_redis.client.DefaultClient',\n        }\n    }\n}\n\nif not DEBUG:\n    SECURE_SSL_REDIRECT = True\n    SESSION_COOKIE_SECURE = True\n    CSRF_COOKIE_SECURE = True\n    SECURE_BROWSER_XSS_FILTER = True\n    SECURE_CONTENT_TYPE_NOSNIFF = True\n    X_FRAME_OPTIONS = 'DENY'\n","size_bytes":5983},"elearning_platform/bookings/__init__.py":{"content":"","size_bytes":0},"elearning_platform/bookings/views.py":{"content":"from django.shortcuts import render\n\n# Create your views here.\n","size_bytes":63},"elearning_platform/analytics/tests.py":{"content":"from django.test import TestCase\n\n# Create your tests here.\n","size_bytes":60},"elearning_platform/analytics/apps.py":{"content":"from django.apps import AppConfig\n\n\nclass AnalyticsConfig(AppConfig):\n    default_auto_field = 'django.db.models.BigAutoField'\n    name = 'analytics'\n","size_bytes":150},"elearning_platform/messaging/__init__.py":{"content":"","size_bytes":0},"elearning_platform/accounts/tests.py":{"content":"from django.test import TestCase\n\n# Create your tests here.\n","size_bytes":60},"elearning_platform/payments/models.py":{"content":"from django.db import models\nfrom django.conf import settings\n\n\nclass Payment(models.Model):\n    PROVIDER_CHOICES = (\n        ('stripe', 'Stripe'),\n        ('paypal', 'PayPal'),\n        ('wise', 'Wise'),\n    )\n    \n    STATUS_CHOICES = (\n        ('pending', 'Pending'),\n        ('processing', 'Processing'),\n        ('succeeded', 'Succeeded'),\n        ('failed', 'Failed'),\n        ('refunded', 'Refunded'),\n    )\n    \n    booking = models.ForeignKey('bookings.Booking', on_delete=models.CASCADE, related_name='payments')\n    user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.CASCADE, related_name='payments')\n    provider = models.CharField(max_length=20, choices=PROVIDER_CHOICES, default='stripe')\n    amount = models.DecimalField(max_digits=10, decimal_places=2)\n    currency = models.CharField(max_length=10, default='USD')\n    status = models.CharField(max_length=20, choices=STATUS_CHOICES, default='pending')\n    transaction_id = models.CharField(max_length=255, blank=True, null=True)\n    payment_intent_id = models.CharField(max_length=255, blank=True, null=True)\n    metadata = models.JSONField(blank=True, null=True)\n    created_at = models.DateTimeField(auto_now_add=True)\n    updated_at = models.DateTimeField(auto_now=True)\n    \n    class Meta:\n        db_table = 'payments'\n        verbose_name = 'Payment'\n        verbose_name_plural = 'Payments'\n        ordering = ['-created_at']\n    \n    def __str__(self):\n        return f\"Payment #{self.id} - {self.amount} {self.currency} - {self.status}\"\n\n\nclass TutorWallet(models.Model):\n    tutor = models.OneToOneField(\n        settings.AUTH_USER_MODEL,\n        on_delete=models.CASCADE,\n        related_name='wallet'\n    )\n    available_balance = models.DecimalField(max_digits=10, decimal_places=2, default=0.00)\n    pending_balance = models.DecimalField(max_digits=10, decimal_places=2, default=0.00)\n    total_earned = models.DecimalField(max_digits=10, decimal_places=2, default=0.00)\n    currency = models.CharField(max_length=10, default='USD')\n    created_at = models.DateTimeField(auto_now_add=True)\n    updated_at = models.DateTimeField(auto_now=True)\n    \n    class Meta:\n        db_table = 'tutor_wallets'\n        verbose_name = 'Tutor Wallet'\n        verbose_name_plural = 'Tutor Wallets'\n    \n    def __str__(self):\n        return f\"{self.tutor.email} - Wallet\"\n    \n    def add_earnings(self, amount, is_pending=True):\n        if is_pending:\n            self.pending_balance += amount\n        else:\n            self.available_balance += amount\n        self.total_earned += amount\n        self.save()\n    \n    def release_pending_to_available(self, amount):\n        if self.pending_balance >= amount:\n            self.pending_balance -= amount\n            self.available_balance += amount\n            self.save()\n            return True\n        return False\n    \n    def withdraw(self, amount):\n        if self.available_balance >= amount:\n            self.available_balance -= amount\n            self.save()\n            return True\n        return False\n\n\nclass WithdrawalRequest(models.Model):\n    STATUS_CHOICES = (\n        ('pending', 'Pending'),\n        ('approved', 'Approved'),\n        ('processing', 'Processing'),\n        ('completed', 'Completed'),\n        ('rejected', 'Rejected'),\n    )\n    \n    PAYOUT_METHOD_CHOICES = (\n        ('paypal', 'PayPal'),\n        ('wise', 'Wise'),\n        ('bank_transfer', 'Bank Transfer'),\n    )\n    \n    tutor = models.ForeignKey(\n        settings.AUTH_USER_MODEL,\n        on_delete=models.CASCADE,\n        related_name='withdrawal_requests'\n    )\n    amount = models.DecimalField(max_digits=10, decimal_places=2)\n    currency = models.CharField(max_length=10, default='USD')\n    status = models.CharField(max_length=20, choices=STATUS_CHOICES, default='pending')\n    payout_method = models.CharField(max_length=20, choices=PAYOUT_METHOD_CHOICES, default='paypal')\n    payout_details = models.JSONField(help_text='Payment details like email, account number, etc.')\n    admin_notes = models.TextField(blank=True, null=True)\n    transaction_id = models.CharField(max_length=255, blank=True, null=True)\n    created_at = models.DateTimeField(auto_now_add=True)\n    updated_at = models.DateTimeField(auto_now=True)\n    processed_at = models.DateTimeField(blank=True, null=True)\n    \n    class Meta:\n        db_table = 'withdrawal_requests'\n        verbose_name = 'Withdrawal Request'\n        verbose_name_plural = 'Withdrawal Requests'\n        ordering = ['-created_at']\n    \n    def __str__(self):\n        return f\"Withdrawal #{self.id} - {self.tutor.email} - {self.amount} {self.currency}\"\n","size_bytes":4624},"elearning_platform/payments/views.py":{"content":"from django.shortcuts import render\n\n# Create your views here.\n","size_bytes":63},"elearning_platform/payments/__init__.py":{"content":"","size_bytes":0},"elearning_platform/bookings/tests.py":{"content":"from django.test import TestCase\n\n# Create your tests here.\n","size_bytes":60},"elearning_platform/messaging/models.py":{"content":"from django.db import models\nfrom django.conf import settings\n\n\nclass Conversation(models.Model):\n    participants = models.ManyToManyField(settings.AUTH_USER_MODEL, related_name='conversations')\n    booking = models.ForeignKey(\n        'bookings.Booking',\n        on_delete=models.CASCADE,\n        related_name='conversations',\n        blank=True,\n        null=True\n    )\n    created_at = models.DateTimeField(auto_now_add=True)\n    updated_at = models.DateTimeField(auto_now=True)\n    \n    class Meta:\n        db_table = 'conversations'\n        verbose_name = 'Conversation'\n        verbose_name_plural = 'Conversations'\n        ordering = ['-updated_at']\n    \n    def __str__(self):\n        participant_emails = ', '.join([p.email for p in self.participants.all()[:2]])\n        return f\"Conversation: {participant_emails}\"\n\n\nclass Message(models.Model):\n    conversation = models.ForeignKey(Conversation, on_delete=models.CASCADE, related_name='messages')\n    sender = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.CASCADE, related_name='sent_messages')\n    content = models.TextField()\n    is_read = models.BooleanField(default=False)\n    created_at = models.DateTimeField(auto_now_add=True)\n    updated_at = models.DateTimeField(auto_now=True)\n    \n    class Meta:\n        db_table = 'messages'\n        verbose_name = 'Message'\n        verbose_name_plural = 'Messages'\n        ordering = ['created_at']\n    \n    def __str__(self):\n        return f\"Message from {self.sender.email} at {self.created_at}\"\n","size_bytes":1523},"elearning_platform/wsgi.py":{"content":"\"\"\"\nWSGI config for elearning_platform project.\n\nIt exposes the WSGI callable as a module-level variable named ``application``.\n\nFor more information on this file, see\nhttps://docs.djangoproject.com/en/4.2/howto/deployment/wsgi/\n\"\"\"\n\nimport os\n\nfrom django.core.wsgi import get_wsgi_application\n\nos.environ.setdefault('DJANGO_SETTINGS_MODULE', 'elearning_platform.settings')\n\napplication = get_wsgi_application()\n","size_bytes":413},"elearning_platform/accounts/models.py":{"content":"from django.contrib.auth.models import AbstractUser, BaseUserManager\nfrom django.db import models\nfrom django.utils import timezone\nimport uuid\n\n\nclass CustomUserManager(BaseUserManager):\n    def create_user(self, email, password=None, **extra_fields):\n        if not email:\n            raise ValueError('Email is required')\n        email = self.normalize_email(email)\n        user = self.model(email=email, **extra_fields)\n        user.set_password(password)\n        user.save(using=self._db)\n        return user\n\n    def create_superuser(self, email, password=None, **extra_fields):\n        extra_fields.setdefault('is_staff', True)\n        extra_fields.setdefault('is_superuser', True)\n        extra_fields.setdefault('role', 'admin')\n        extra_fields.setdefault('email_verified', True)\n        return self.create_user(email, password, **extra_fields)\n\n\nclass CustomUser(AbstractUser):\n    ROLE_CHOICES = (\n        ('student', 'Student'),\n        ('tutor', 'Tutor'),\n        ('admin', 'Admin'),\n    )\n    \n    username = None\n    email = models.EmailField(unique=True)\n    role = models.CharField(max_length=20, choices=ROLE_CHOICES, default='student')\n    email_verified = models.BooleanField(default=False)\n    email_verification_token = models.CharField(max_length=255, blank=True, null=True)\n    email_verification_token_created = models.DateTimeField(blank=True, null=True)\n    password_reset_token = models.CharField(max_length=255, blank=True, null=True)\n    password_reset_token_created = models.DateTimeField(blank=True, null=True)\n    created_at = models.DateTimeField(auto_now_add=True)\n    updated_at = models.DateTimeField(auto_now=True)\n    \n    USERNAME_FIELD = 'email'\n    REQUIRED_FIELDS = []\n    \n    objects = CustomUserManager()\n    \n    class Meta:\n        db_table = 'users'\n        verbose_name = 'User'\n        verbose_name_plural = 'Users'\n    \n    def __str__(self):\n        return self.email\n    \n    def generate_verification_token(self):\n        self.email_verification_token = str(uuid.uuid4())\n        self.email_verification_token_created = timezone.now()\n        self.save()\n        return self.email_verification_token\n    \n    def verify_email_token(self, token):\n        from datetime import timedelta\n        from django.conf import settings\n        \n        if self.email_verification_token != token:\n            return False\n        \n        if not self.email_verification_token_created:\n            return False\n        \n        expiry_time = self.email_verification_token_created + timedelta(\n            minutes=settings.EMAIL_VERIFICATION_TIMEOUT_MINUTES\n        )\n        \n        if timezone.now() > expiry_time:\n            return False\n        \n        self.email_verified = True\n        self.email_verification_token = None\n        self.email_verification_token_created = None\n        self.save()\n        return True\n    \n    def generate_password_reset_token(self):\n        self.password_reset_token = str(uuid.uuid4())\n        self.password_reset_token_created = timezone.now()\n        self.save()\n        return self.password_reset_token\n    \n    def verify_password_reset_token(self, token):\n        from datetime import timedelta\n        from django.conf import settings\n        \n        if self.password_reset_token != token:\n            return False\n        \n        if not self.password_reset_token_created:\n            return False\n        \n        expiry_time = self.password_reset_token_created + timedelta(\n            minutes=settings.PASSWORD_RESET_TIMEOUT_MINUTES\n        )\n        \n        if timezone.now() > expiry_time:\n            return False\n        \n        return True\n\n\nclass TutorProfile(models.Model):\n    APPROVAL_STATUS_CHOICES = (\n        ('pending', 'Pending'),\n        ('approved', 'Approved'),\n        ('rejected', 'Rejected'),\n    )\n    \n    user = models.OneToOneField(CustomUser, on_delete=models.CASCADE, related_name='tutor_profile')\n    bio = models.TextField(blank=True)\n    skills = models.TextField(blank=True)\n    price_per_lesson = models.DecimalField(max_digits=10, decimal_places=2, default=0.00)\n    approval_status = models.CharField(max_length=20, choices=APPROVAL_STATUS_CHOICES, default='pending')\n    cv = models.FileField(upload_to='tutors/cvs/', blank=True, null=True)\n    certificate = models.FileField(upload_to='tutors/certificates/', blank=True, null=True)\n    rating = models.DecimalField(max_digits=3, decimal_places=2, default=0.00)\n    total_ratings = models.IntegerField(default=0)\n    courses_taught = models.IntegerField(default=0)\n    wallet_balance = models.DecimalField(max_digits=10, decimal_places=2, default=0.00)\n    is_featured = models.BooleanField(default=False)\n    created_at = models.DateTimeField(auto_now_add=True)\n    updated_at = models.DateTimeField(auto_now=True)\n    \n    class Meta:\n        db_table = 'tutor_profiles'\n        verbose_name = 'Tutor Profile'\n        verbose_name_plural = 'Tutor Profiles'\n    \n    def __str__(self):\n        return f\"{self.user.email} - Tutor Profile\"\n    \n    def update_rating(self, new_rating):\n        total = self.rating * self.total_ratings\n        self.total_ratings += 1\n        self.rating = (total + new_rating) / self.total_ratings\n        self.save()\n\n\nclass StudentProfile(models.Model):\n    user = models.OneToOneField(CustomUser, on_delete=models.CASCADE, related_name='student_profile')\n    bio = models.TextField(blank=True)\n    language = models.CharField(max_length=50, blank=True)\n    country = models.CharField(max_length=100, blank=True)\n    currency = models.CharField(max_length=10, default='USD')\n    created_at = models.DateTimeField(auto_now_add=True)\n    updated_at = models.DateTimeField(auto_now=True)\n    \n    class Meta:\n        db_table = 'student_profiles'\n        verbose_name = 'Student Profile'\n        verbose_name_plural = 'Student Profiles'\n    \n    def __str__(self):\n        return f\"{self.user.email} - Student Profile\"\n","size_bytes":5937},"elearning_platform/accounts/__init__.py":{"content":"","size_bytes":0}},"version":2}